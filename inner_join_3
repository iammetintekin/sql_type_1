--ÜRÜN KATEGORİLERİNE GÖRE SİPARİŞ DAĞILIMI
SELECT 
IT.CATEGORY1,IT.CATEGORY2,
SUM(OD.LINETOTAL) AS TOPLAMSIPARISTUTARI,
SUM(OD.AMOUNT) AS TOPLAMSIPARISADETI,
COUNT(OD.ID) AS TOPLAMSIPARISADETI,
SUM(OD.LINETOTAL)/SUM(OD.AMOUNT) AS ORTALAMABIRIMFIYAT
FROM ORDERS O
INNER JOIN USERS U ON U.ID=O.USERID
INNER JOIN ADDRESS A ON A.ID=O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID = A.CITYID
INNER JOIN TOWNS T ON T.ID = A.TOWNID
INNER JOIN DISTRICTS D ON D.ID = A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID = O.ID
INNER JOIN INVOICES I ON I.ORDERID = O.ID
INNER JOIN ORDERDETAILS OD ON OD.ORDERID = O.ID
INNER JOIN ITEMS IT ON IT.ID = OD.ITEMID
WHERE IT.CATEGORY1='KOZMETIK'
GROUP BY IT.CATEGORY1, IT.CATEGORY2
order by TOPLAMSIPARISTUTARI DESC
 
 
--GÜNLERE GÖRE SİPARİŞ DAĞILIMI
SELECT 
CONVERT(DATE,O.DATE_) AS TARİH,
SUM(OD.LINETOTAL) AS TOPLAMSIPARISTUTARI,
SUM(OD.AMOUNT) AS TOPLAMSIPARISADETI,
COUNT(OD.ID) AS TOPLAMSIPARISADETI,
SUM(OD.LINETOTAL)/SUM(OD.AMOUNT) AS ORTALAMABIRIMFIYAT
 FROM ORDERS O
INNER JOIN USERS U ON U.ID=O.USERID
INNER JOIN ADDRESS A ON A.ID=O.ADDRESSID
INNER JOIN CITIES CT ON CT.ID = A.CITYID
INNER JOIN TOWNS T ON T.ID = A.TOWNID
INNER JOIN DISTRICTS D ON D.ID = A.DISTRICTID
INNER JOIN PAYMENTS P ON P.ORDERID = O.ID
INNER JOIN INVOICES I ON I.ORDERID = O.ID
INNER JOIN ORDERDETAILS OD ON OD.ORDERID = O.ID
INNER JOIN ITEMS IT ON IT.ID = OD.ITEMID
WHERE IT.CATEGORY1='KOZMETIK'
GROUP BY CONVERT(DATE,O.DATE_)
order by CONVERT(DATE,O.DATE_)

 
